<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="DesignLibrary">
<title>Binary Instrumental Variable • DesignLibrary</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Binary Instrumental Variable">
<meta property="og:description" content="DesignLibrary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">DesignLibrary</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.1.10</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/How_to_Write_and_Contribute_Designers.html">How to Write and Contribute Designers</a>
    <a class="dropdown-item" href="../articles/How_to_Write_and_Contribute_Designs.html">How to Write and Contribute Designs</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-software">Software</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-software">
    <a class="external-link dropdown-item" href="http://declaredesign.org/r/declaredesign/">DeclareDesign</a>
    <a class="external-link dropdown-item" href="https://declaredesign.org/r/randomizr/">randomizr</a>
    <a class="external-link dropdown-item" href="https://declaredesign.org/r/fabricatr/">fabricatr</a>
    <a class="external-link dropdown-item" href="https://declaredesign.org/r/estimatr/">estimatr</a>
  </div>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://declaredesign.org">declaredesign.org</a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">



<script src="binary_iv_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Binary Instrumental Variable</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/DeclareDesign/DesignLibrary/blob/HEAD/../vignettes/binary_iv.Rmd" class="external-link"><code>../vignettes/binary_iv.Rmd</code></a></small>
      <div class="d-none name"><code>binary_iv.Rmd</code></div>
    </div>

    
    
<p>Instrumental variables methods are often used in experimental or observational settings where we <em>cannot</em> credibly assume the treatment of interest is randomly assigned, but can assume the treatment is assigned my some third variable that’s unrelated to the outcome of interest.</p>
<p>Take two examples of causal relationships researchers might be interested in observing: the effect of distributive benefits on voter turnout and the effect of fertilizer use on farmers’ crop yield. In both cases, the distribution of resources or the use of fertilizer may depend on the outcome we wish to study — on the one hand, politicians may disburse funds according to local electoral characteristics, and on the other, famers with higher crop yield might be both more likely to use fertilizers. Instrumental variables can be a useful approach in these contexts where a treatment <span class="math inline">\(X\)</span> is endogenous to an outcome <span class="math inline">\(Y\)</span>.</p>
<p>Strong instrumental variables satisfy four key assumptions:</p>
<ul>
<li>
<em>Relevance</em>: The instrument <span class="math inline">\(Z\)</span> has a causal effect on the treatment <span class="math inline">\(X\)</span>.</li>
<li>
<em>Exclusion restriction</em>: The instrument <span class="math inline">\(Z\)</span> affects the outcome <span class="math inline">\(Y\)</span> only through the treatment <span class="math inline">\(X\)</span>.</li>
<li>
<em>Exchangeability</em> (or <em>independence</em>): The instrument <span class="math inline">\(Z\)</span> is as good as randomly assigned (i.e., there is no confounding for the effect of <span class="math inline">\(Z\)</span> on <span class="math inline">\(Y\)</span>).</li>
<li>
<em>Monotonicity</em>: For all units <span class="math inline">\(i\)</span>, <span class="math inline">\(X_i(z_1) \geqslant X_i(x_2)\)</span> when <span class="math inline">\(z_1 \geqslant z_2\)</span> (i.e., there are no units that always defy their assignment).</li>
</ul>
<p>Using the examples above, researchers could choose to instrument distributive benefits with a naturally occurring disaster — the occurence of a hurricane is correlated with the disbursement of relief aid by the government but may be independent of voter turnout. Similarly, researchers might randomly assign some farmers fertilizer vouchers as an instrument for fertilizer use.</p>
<p>The <code><a href="../reference/binary_iv_designer.html">binary_iv_designer()</a></code> function allows researchers to declare a design of a single instrument <span class="math inline">\(Z\)</span> to estimate the effect of an endogenous treatment <span class="math inline">\(X\)</span> on an outcome <span class="math inline">\(Y\)</span>, all of which are binary variables. Below we declare a design using the fertilizer example.</p>
<div class="section level2">
<h2 id="design-declaration">Design Declaration<a class="anchor" aria-label="anchor" href="#design-declaration"></a>
</h2>
<ul>
<li>
<p><strong>M</strong>odel:</p>
<p>We assume our sample has three out of four possible compliance types in a sample of <span class="math inline">\(N\)</span> farmers: always-takers, never-takers, and compliers. In order for the monotonicy assumption to hold, we assume there are no defiers in our sample (no farmers who will adopt fertilizer use if not given the voucher, and who will not adopt it if given the voucher). Below is how we define <span class="math inline">\(X(Z)\)</span> with <span class="math inline">\(Z \in {0,1}\)</span> for each type:</p>
<table class="table">
<thead><tr class="header">
<th align="left">Type</th>
<th align="right"><span class="math inline">\(X_i(0)\)</span></th>
<th align="right"><span class="math inline">\(X_i(1)\)</span></th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Always-taker</td>
<td align="right">1</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">Never-taker</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">Complier</td>
<td align="right">0</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">Defier</td>
<td align="right">1</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
<p>We consider a population of size <span class="math inline">\(N\)</span> and we define potential outcome <span class="math inline">\(Y\)</span> (in this case crop yield) as a linear function of the form <span class="math inline">\(Y_{i,type} = \alpha_{type} + \beta_{type} * X_i + \delta_{type} * Z_i + u_y\)</span>, where <span class="math inline">\(u_y\)</span> is a normally distributed individual-level shock. We consider the treatment to have heterogeneous effects among different complier types.</p>
</li>
<li>
<p><strong>I</strong>nquiry:</p>
<p>Firstly, we define the first-stage effect of <span class="math inline">\(Z\)</span> on <span class="math inline">\(X\)</span> as <span class="math inline">\(E[X(Z=1) - X(Z=0)]\)</span>.</p>
<p>Our second estimand of interest is the average effect of fertilizer use (our endogenous treatment, <span class="math inline">\(X\)</span>), on crop productivity: <span class="math inline">\(ATE = E[Y(X = 1) - Y(X = 0)]\)</span>.</p>
<p>Thirdly, we are interested in the average treatment effect among compliers (farmers who use fertilizers when awarded the vouchers but who will not use it if not given voucher): <span class="math inline">\(LATE = E[Y(X = 1) - Y(X = 0) | type_i = complier]\)</span>.</p>
<p>Lastly, when monotonicity does not hold, but independence and exclusion restriction do, we define the estimand as a weighted average of treatment effects for compliers and defiers: <span class="math inline">\(LATE_{het} = \frac{Pr(type = c)}{Pr(type = c) - Pr(type = d)}*E[Y_i(1)-Y_i(0)| type = c] - \frac{Pr(type = d)}{Pr(type = c) - Pr(type = d)}*E[Y_i(1)-Y_i(0)| type = d]\)</span>, where <span class="math inline">\(c\)</span> and <span class="math inline">\(d\)</span> are compliers and defiers, respectively <span class="citation">(see Imbens 2014: 34)</span>.</p>
</li>
<li>
<p><strong>D</strong>ata strategy:</p>
<p>We collect survey data on a representative sample of 400 farmers and randomly assign fertilizer vouchers with a probability of 0.5.</p>
</li>
<li>
<p><strong>A</strong>nswer strategy:</p>
<p>We estimate the first-stage effect by calculating the difference-in-means estimator of the function <span class="math inline">\(X ~ Z\)</span>. For an estimation of the <span class="math inline">\(ATE\)</span>, <span class="math inline">\(LATE\)</span>, and <span class="math inline">\(LATE_{het}\)</span> we estimate the effect of endogenous treatment <span class="math inline">\(X\)</span> on <span class="math inline">\(Y\)</span> and use a two-stage least squares (2SLS) estimation.</p>
</li>
</ul>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">N</span> <span class="op">&lt;-</span> <span class="fl">100</span></span>
<span><span class="va">type_probs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">assignment_probs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span><span class="op">)</span></span>
<span><span class="va">outcome_sd</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span><span class="va">a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">b</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span><span class="op">)</span></span>
<span><span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span></span>
<span></span>
<span><span class="va">population</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://declaredesign.org/r/declaredesign/reference/declare_population.html" class="external-link">declare_population</a></span><span class="op">(</span>N <span class="op">=</span> <span class="va">N</span>, type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, </span>
<span>    <span class="va">N</span>, replace <span class="op">=</span> <span class="cn">TRUE</span>, prob <span class="op">=</span> <span class="va">type_probs</span><span class="op">)</span>, type_label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Always"</span>, </span>
<span>    <span class="st">"Never"</span>, <span class="st">"Complier"</span>, <span class="st">"Defier"</span><span class="op">)</span><span class="op">[</span><span class="va">type</span><span class="op">]</span>, u_Z <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">N</span><span class="op">)</span>, </span>
<span>    u_Y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">N</span><span class="op">)</span> <span class="op">*</span> <span class="va">outcome_sd</span>, Z <span class="op">=</span> <span class="op">(</span><span class="va">u_Z</span> <span class="op">&lt;</span> <span class="va">assignment_probs</span><span class="op">[</span><span class="va">type</span><span class="op">]</span><span class="op">)</span>, </span>
<span>    X <span class="op">=</span> <span class="op">(</span><span class="va">type</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span><span class="va">type</span> <span class="op">==</span> <span class="fl">3</span><span class="op">)</span> <span class="op">*</span> <span class="va">Z</span> <span class="op">+</span> <span class="op">(</span><span class="va">type</span> <span class="op">==</span> <span class="fl">4</span><span class="op">)</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> </span>
<span>        <span class="va">Z</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">potential_outcomes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://declaredesign.org/r/declaredesign/reference/declare_potential_outcomes.html" class="external-link">declare_potential_outcomes</a></span><span class="op">(</span><span class="va">Y</span> <span class="op">~</span> <span class="va">a</span><span class="op">[</span><span class="va">type</span><span class="op">]</span> <span class="op">+</span> </span>
<span>    <span class="va">b</span><span class="op">[</span><span class="va">type</span><span class="op">]</span> <span class="op">*</span> <span class="va">X</span> <span class="op">+</span> <span class="va">d</span><span class="op">[</span><span class="va">type</span><span class="op">]</span> <span class="op">*</span> <span class="va">Z</span> <span class="op">+</span> <span class="va">u_Y</span>, assignment_variables <span class="op">=</span> <span class="st">"X"</span><span class="op">)</span></span>
<span><span class="va">reveal</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://declaredesign.org/r/declaredesign/reference/declare_reveal.html" class="external-link">declare_reveal</a></span><span class="op">(</span>outcome_variables <span class="op">=</span> <span class="va">Y</span>, assignment_variables <span class="op">=</span> <span class="st">"X"</span><span class="op">)</span></span>
<span><span class="va">estimand</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://declaredesign.org/r/declaredesign/reference/declare_inquiry.html" class="external-link">declare_inquiry</a></span><span class="op">(</span>first_stage <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="op">(</span><span class="va">type</span> <span class="op">==</span> <span class="fl">3</span><span class="op">)</span> <span class="op">-</span> </span>
<span>    <span class="op">(</span><span class="va">type</span> <span class="op">==</span> <span class="fl">4</span><span class="op">)</span><span class="op">)</span>, ate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">Y_X_1</span> <span class="op">-</span> <span class="va">Y_X_0</span><span class="op">)</span>, late <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">Y_X_1</span><span class="op">[</span><span class="va">type</span> <span class="op">==</span> </span>
<span>    <span class="fl">3</span><span class="op">]</span> <span class="op">-</span> <span class="va">Y_X_0</span><span class="op">[</span><span class="va">type</span> <span class="op">==</span> <span class="fl">3</span><span class="op">]</span><span class="op">)</span>, late_het <span class="op">=</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">type</span> <span class="op">==</span> <span class="fl">3</span><span class="op">)</span> <span class="op">*</span> </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">Y_X_1</span><span class="op">[</span><span class="va">type</span> <span class="op">==</span> <span class="fl">3</span><span class="op">]</span> <span class="op">-</span> <span class="va">Y_X_0</span><span class="op">[</span><span class="va">type</span> <span class="op">==</span> <span class="fl">3</span><span class="op">]</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">type</span> <span class="op">==</span> </span>
<span>    <span class="fl">4</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">Y_X_1</span><span class="op">[</span><span class="va">type</span> <span class="op">==</span> <span class="fl">4</span><span class="op">]</span> <span class="op">-</span> <span class="va">Y_X_0</span><span class="op">[</span><span class="va">type</span> <span class="op">==</span> <span class="fl">4</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">type</span> <span class="op">==</span> </span>
<span>    <span class="fl">3</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">type</span> <span class="op">==</span> <span class="fl">4</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">estimator_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://declaredesign.org/r/declaredesign/reference/declare_estimator.html" class="external-link">declare_estimator</a></span><span class="op">(</span><span class="va">X</span> <span class="op">~</span> <span class="va">Z</span>, model <span class="op">=</span> <span class="va">difference_in_means</span>, </span>
<span>    inquiry <span class="op">=</span> <span class="st">"first_stage"</span>, label <span class="op">=</span> <span class="st">"d-i-m"</span><span class="op">)</span></span>
<span><span class="va">estimator_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://declaredesign.org/r/declaredesign/reference/declare_estimator.html" class="external-link">declare_estimator</a></span><span class="op">(</span><span class="va">Y</span> <span class="op">~</span> <span class="va">X</span>, inquiry <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ate"</span>, </span>
<span>    <span class="st">"late"</span>, <span class="st">"late_het"</span><span class="op">)</span>, model <span class="op">=</span> <span class="va">lm_robust</span>, label <span class="op">=</span> <span class="st">"lm_robust"</span><span class="op">)</span></span>
<span><span class="va">estimator_3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://declaredesign.org/r/declaredesign/reference/declare_estimator.html" class="external-link">declare_estimator</a></span><span class="op">(</span><span class="va">Y</span> <span class="op">~</span> <span class="va">X</span> <span class="op">|</span> <span class="va">Z</span>, inquiry <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ate"</span>, </span>
<span>    <span class="st">"late"</span>, <span class="st">"late_het"</span><span class="op">)</span>, model <span class="op">=</span> <span class="va">iv_robust</span>, label <span class="op">=</span> <span class="st">"iv_robust"</span><span class="op">)</span></span>
<span><span class="va">binary_iv_design</span> <span class="op">&lt;-</span> <span class="va">population</span> <span class="op">+</span> <span class="va">potential_outcomes</span> <span class="op">+</span> <span class="va">reveal</span> <span class="op">+</span> </span>
<span>    <span class="va">estimand</span> <span class="op">+</span> <span class="va">estimator_1</span> <span class="op">+</span> <span class="va">estimator_2</span> <span class="op">+</span> <span class="va">estimator_3</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="takeaways">Takeaways<a class="anchor" aria-label="anchor" href="#takeaways"></a>
</h2>
<p>We now diagnose the design above and compare our estimates with those of designs that violate the first three assumptions one by one.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Violate relevance of instrument for treatment (no first-stage effects)</span></span>
<span><span class="va">iv_nonrelevant</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/binary_iv_designer.html">binary_iv_designer</a></span><span class="op">(</span>N <span class="op">=</span> <span class="fl">500</span>, assignment_probs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.2</span>, <span class="fl">.3</span>, <span class="fl">.7</span>, <span class="fl">.5</span><span class="op">)</span>, b_Y <span class="op">=</span> <span class="fl">.5</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Violate relevance of instrument for treatment (no first-stage effects)</span></span>
<span><span class="va">iv_nonrandom</span>   <span class="op">&lt;-</span> <span class="fu"><a href="../reference/binary_iv_designer.html">binary_iv_designer</a></span><span class="op">(</span>type_probs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.5</span>,<span class="fl">.5</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>, b_Y <span class="op">=</span> <span class="fl">.5</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Violate exclusion restriction</span></span>
<span><span class="va">iv_nonexcl</span>     <span class="op">&lt;-</span> <span class="fu"><a href="../reference/binary_iv_designer.html">binary_iv_designer</a></span><span class="op">(</span>d_Y <span class="op">=</span> <span class="fl">.1</span><span class="op">)</span></span></code></pre></div>
<p>We also compare estimates across designs in which we assume violation of the monotonicity assumption with homogeneous and heterogeneous treatment effects across complier types.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Violates monotonicity with homogeneous treatment effects</span></span>
<span><span class="va">iv_defiers</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/binary_iv_designer.html">binary_iv_designer</a></span><span class="op">(</span>type_probs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">.8</span>,<span class="fl">.2</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Violates monotonicity with heterogeneous treatment effects</span></span>
<span><span class="va">iv_het</span>     <span class="op">&lt;-</span> <span class="fu"><a href="../reference/binary_iv_designer.html">binary_iv_designer</a></span><span class="op">(</span>type_probs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">.8</span>,<span class="fl">.2</span><span class="op">)</span>, </span>
<span>                                 b <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">diagnoses</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://declaredesign.org/r/declaredesign/reference/diagnose_design.html" class="external-link">diagnose_designs</a></span><span class="op">(</span><span class="va">iv_nonrelevant</span>, <span class="va">iv_nonrandom</span>, </span>
<span>                              <span class="va">iv_nonexcl</span>, <span class="va">iv_defiers</span>, <span class="va">iv_het</span>, sims <span class="op">=</span> <span class="fl">25</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## 1 coefficient  not defined because the design matrix is rank deficient</span></span></code></pre>
<p>We highlight a few takeaways. Firstly, our estimates are unbiased when all assumption hold. We show that violating any of the first three assumptions yields biased estimates.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">diagnoses_table</span><span class="op">[</span></span>
<span>  <span class="va">diagnoses_table</span><span class="op">$</span><span class="va">`Inquiry`</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"late"</span>, <span class="st">"ate"</span><span class="op">)</span> <span class="op">&amp;</span></span>
<span>    <span class="va">diagnoses_table</span><span class="op">$</span><span class="va">`Design`</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"binary_iv_design"</span>,<span class="st">"iv_nonrelevant"</span>, </span>
<span>                                          <span class="st">"iv_nonrandom"</span>, <span class="st">"iv_nonexcl"</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, <span class="fl">6</span>, <span class="fl">8</span>, <span class="fl">14</span><span class="op">)</span><span class="op">]</span>, digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p>In the absence of the monotonicity assumption, our IV estimates are less biased for the LATE than the ATE estimand in the presence of heterogeneous treatment effects. Moreover, in these cases, the IV is best at estimating the weighted average of treatment effects for compliers and defiers (<span class="math inline">\(LATE_{het}\)</span>).</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">diagnoses_table</span><span class="op">[</span><span class="va">diagnoses_table</span><span class="op">$</span><span class="va">`Inquiry`</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ate"</span>, <span class="st">"late"</span>, <span class="st">"late_het"</span><span class="op">)</span> <span class="op">&amp;</span></span>
<span>                        <span class="va">diagnoses_table</span><span class="op">$</span><span class="va">`Design`</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"iv_defiers"</span>, <span class="st">"iv_het"</span><span class="op">)</span> <span class="op">&amp;</span></span>
<span>                        <span class="va">diagnoses_table</span><span class="op">$</span><span class="va">Bias</span><span class="op">!=</span> <span class="st">"NA"</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, <span class="fl">6</span>, <span class="fl">8</span>,<span class="fl">14</span><span class="op">)</span><span class="op">]</span>, digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2 unnumbered">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references">
<div id="ref-imbens2014instrumental">
<p>Imbens, Guido. 2014. “Instrumental Variables: An Econometrician’s Perspective.” National Bureau of Economic Research.</p>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Graeme Blair, Jasper Cooper, Alexander Coppock, Macartan Humphreys, Clara Bicalho, Neal Fultz, Lily Medina.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
