<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="DesignLibrary">
<title>Factorial Designs • DesignLibrary</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Factorial Designs">
<meta property="og:description" content="DesignLibrary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">DesignLibrary</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.1.10</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/How_to_Write_and_Contribute_Designers.html">How to Write and Contribute Designers</a>
    <a class="dropdown-item" href="../articles/How_to_Write_and_Contribute_Designs.html">How to Write and Contribute Designs</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-software">Software</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-software">
    <a class="external-link dropdown-item" href="http://declaredesign.org/r/declaredesign/">DeclareDesign</a>
    <a class="external-link dropdown-item" href="https://declaredesign.org/r/randomizr/">randomizr</a>
    <a class="external-link dropdown-item" href="https://declaredesign.org/r/fabricatr/">fabricatr</a>
    <a class="external-link dropdown-item" href="https://declaredesign.org/r/estimatr/">estimatr</a>
    <a class="dropdown-item" href="https://declaredesign.org/r/designlibrary/">DesignLibrary</a>
    <a class="external-link dropdown-item" href="https://eos.wzb.eu/ipi/DDWizard/">DesignWizard</a>
  </div>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://declaredesign.org">declaredesign.org</a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">



<script src="factorial_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Factorial Designs</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/DeclareDesign/DesignLibrary/blob/HEAD/../vignettes/factorial.Rmd" class="external-link"><code>../vignettes/factorial.Rmd</code></a></small>
      <div class="d-none name"><code>factorial.Rmd</code></div>
    </div>

    
    
<p>A <span class="math inline">\(2^K\)</span> factorial design is an extension of the <code>two_by_two_designer</code> that allows for <span class="math inline">\(k\)</span> number of factors (or treatments), each with two levels, resulting in <span class="math inline">\(2^K\)</span> combinations of treatment conditions. You might be interested in testing not just how two, but rather how three, or how any number (<span class="math inline">\(k\)</span>) of treatment conditions interact. The interest in the effect of different treatments in the presence or absence of other treatments is a key distinction from the <code>multi_arm_designer</code>, in which we evaluate the effect of treatments where there is no overlap in the assignment of different conditions.</p>
<p>Let’s say you set out to study how incentives and managerial practices affect employee productivity <em>in combination</em>. Let’s imagine that intervention <span class="math inline">\(A\)</span> is a salary increase conditional on performance indicators, intervention <span class="math inline">\(B\)</span> is increased monitoring, and intervention <span class="math inline">\(C\)</span> is a motivational activity. A key question might be the marginal effect of conditional salary increases on productivity in the presence of greater monitoring or in the presence of motivational interventions, or both.</p>
<div class="section level3">
<h3 id="design-declaration">Design Declaration<a class="anchor" aria-label="anchor" href="#design-declaration"></a>
</h3>
<ul>
<li>
<p><strong>M</strong>odel:</p>
<p>We stipulate <span class="math inline">\(2^k\)</span> potential outcomes. In our example, with treatments <span class="math inline">\(\{A,B,C\} \in \{0,1\}\)</span>, we have <span class="math inline">\(Y^{ABC}\)</span>. We can denote the potential outcome of a unit who is in control for all treatments <span class="math inline">\(Y^{000}_i\)</span>, for example, and that for a unit who is assigned to B and C only as <span class="math inline">\(Y^{011}\)</span>. Each potential outcome is distributed normally with mean <span class="math inline">\(\mu_j\)</span> and standard deviation <span class="math inline">\(\sigma_j\)</span>, where <span class="math inline">\(j \in \{1,...,2^k\}\)</span>.</p>
</li>
<li>
<p><strong>I</strong>nquiry:</p>
<p>Estimands are defined for each combination of treatment assignment as weighted averages of differences in potential outcomes. The effect of A in this design, <span class="math inline">\(\tau_A\)</span>, averaged over conditions defined by B and C, is given by: <span class="math inline">\(\tau_A = 1/4*(Y^{111} - Y^{011}) + 1/4*(Y^{101} - Y^{001}) + 1/4*(Y^{110} - Y^{010}) + 1/4*(Y^{100} - Y^{000})\)</span>.</p>
</li>
<li>
<p><strong>D</strong>ata strategy:</p>
<p>We randomly assign units to one of the <span class="math inline">\(2^k\)</span> combinations of treatment using equal probabilities of assignment.</p>
</li>
<li>
<p><strong>A</strong>nswer strategy:</p>
<p>Estimates draw from a regression in which all treatments are demeaned and weighted by the inverse probability of being in the condition they are in. In this demeaned regression, the constant captures the average outcome across all conditions — not the outcome when all units are in the control condition.</p>
</li>
</ul>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">N</span> <span class="op">&lt;-</span> <span class="fl">256</span></span>
<span><span class="va">outcome_means</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">outcome_sds</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="va">population</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://declaredesign.org/r/declaredesign/reference/declare_population.html" class="external-link">declare_population</a></span><span class="op">(</span><span class="va">N</span><span class="op">)</span></span>
<span><span class="va">potential_outcomes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://declaredesign.org/r/declaredesign/reference/declare_potential_outcomes.html" class="external-link">declare_potential_outcomes</a></span><span class="op">(</span>Y_0_0_0 <span class="op">=</span> <span class="va">outcome_means</span><span class="op">[</span><span class="fl">1L</span><span class="op">]</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">N</span>, </span>
<span>    <span class="fl">0</span>, <span class="va">outcome_sds</span><span class="op">[</span><span class="fl">1L</span><span class="op">]</span><span class="op">)</span>, Y_1_0_0 <span class="op">=</span> <span class="va">outcome_means</span><span class="op">[</span><span class="fl">2L</span><span class="op">]</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">N</span>, </span>
<span>    <span class="fl">0</span>, <span class="va">outcome_sds</span><span class="op">[</span><span class="fl">2L</span><span class="op">]</span><span class="op">)</span>, Y_0_1_0 <span class="op">=</span> <span class="va">outcome_means</span><span class="op">[</span><span class="fl">3L</span><span class="op">]</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">N</span>, </span>
<span>    <span class="fl">0</span>, <span class="va">outcome_sds</span><span class="op">[</span><span class="fl">3L</span><span class="op">]</span><span class="op">)</span>, Y_1_1_0 <span class="op">=</span> <span class="va">outcome_means</span><span class="op">[</span><span class="fl">4L</span><span class="op">]</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">N</span>, </span>
<span>    <span class="fl">0</span>, <span class="va">outcome_sds</span><span class="op">[</span><span class="fl">4L</span><span class="op">]</span><span class="op">)</span>, Y_0_0_1 <span class="op">=</span> <span class="va">outcome_means</span><span class="op">[</span><span class="fl">5L</span><span class="op">]</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">N</span>, </span>
<span>    <span class="fl">0</span>, <span class="va">outcome_sds</span><span class="op">[</span><span class="fl">5L</span><span class="op">]</span><span class="op">)</span>, Y_1_0_1 <span class="op">=</span> <span class="va">outcome_means</span><span class="op">[</span><span class="fl">6L</span><span class="op">]</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">N</span>, </span>
<span>    <span class="fl">0</span>, <span class="va">outcome_sds</span><span class="op">[</span><span class="fl">6L</span><span class="op">]</span><span class="op">)</span>, Y_0_1_1 <span class="op">=</span> <span class="va">outcome_means</span><span class="op">[</span><span class="fl">7L</span><span class="op">]</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">N</span>, </span>
<span>    <span class="fl">0</span>, <span class="va">outcome_sds</span><span class="op">[</span><span class="fl">7L</span><span class="op">]</span><span class="op">)</span>, Y_1_1_1 <span class="op">=</span> <span class="va">outcome_means</span><span class="op">[</span><span class="fl">8L</span><span class="op">]</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">N</span>, </span>
<span>    <span class="fl">0</span>, <span class="va">outcome_sds</span><span class="op">[</span><span class="fl">8L</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">reveal_Y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://declaredesign.org/r/declaredesign/reference/declare_reveal.html" class="external-link">declare_reveal</a></span><span class="op">(</span>handler <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">data</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">potential_cols</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mapply.html" class="external-link">mapply</a></span><span class="op">(</span><span class="va">paste</span>, <span class="va">data</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"T1"</span>, <span class="st">"T2"</span>, <span class="st">"T3"</span></span>
<span>    <span class="op">)</span>, drop <span class="op">=</span> <span class="cn">FALSE</span><span class="op">]</span>, sep <span class="op">=</span> <span class="st">"_"</span>, SIMPLIFY <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span>    <span class="va">potential_cols</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">paste</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Y"</span>, <span class="va">potential_cols</span>, sep <span class="op">=</span> <span class="st">"_"</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">upoc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">potential_cols</span><span class="op">)</span></span>
<span>    <span class="va">df</span> <span class="op">&lt;-</span> <span class="va">data</span><span class="op">[</span>, <span class="va">upoc</span>, drop <span class="op">=</span> <span class="cn">FALSE</span><span class="op">]</span></span>
<span>    <span class="va">R</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">C</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/match.html" class="external-link">match</a></span><span class="op">(</span><span class="va">potential_cols</span>, <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">data</span><span class="op">[</span>, <span class="st">"Y"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">R</span>, <span class="va">C</span><span class="op">)</span><span class="op">]</span></span>
<span>    <span class="va">data</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span><span class="va">estimand</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://declaredesign.org/r/declaredesign/reference/declare_inquiry.html" class="external-link">declare_inquiry</a></span><span class="op">(</span>Overall_average <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="fl">0.125</span> <span class="op">*</span> <span class="va">Y_0_0_0</span> <span class="op">+</span> <span class="fl">0.125</span> <span class="op">*</span> </span>
<span>    <span class="va">Y_0_0_1</span> <span class="op">+</span> <span class="fl">0.125</span> <span class="op">*</span> <span class="va">Y_0_1_0</span> <span class="op">+</span> <span class="fl">0.125</span> <span class="op">*</span> <span class="va">Y_0_1_1</span> <span class="op">+</span> <span class="fl">0.125</span> <span class="op">*</span> <span class="va">Y_1_0_0</span> <span class="op">+</span> </span>
<span>    <span class="fl">0.125</span> <span class="op">*</span> <span class="va">Y_1_0_1</span> <span class="op">+</span> <span class="fl">0.125</span> <span class="op">*</span> <span class="va">Y_1_1_0</span> <span class="op">+</span> <span class="fl">0.125</span> <span class="op">*</span> <span class="va">Y_1_1_1</span><span class="op">)</span>, te_T3 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.25</span> <span class="op">*</span> </span>
<span>    <span class="va">Y_0_0_0</span> <span class="op">+</span> <span class="fl">0.25</span> <span class="op">*</span> <span class="va">Y_0_0_1</span> <span class="op">+</span> <span class="op">-</span><span class="fl">0.25</span> <span class="op">*</span> <span class="va">Y_0_1_0</span> <span class="op">+</span> <span class="fl">0.25</span> <span class="op">*</span> <span class="va">Y_0_1_1</span> <span class="op">+</span> </span>
<span>    <span class="op">-</span><span class="fl">0.25</span> <span class="op">*</span> <span class="va">Y_1_0_0</span> <span class="op">+</span> <span class="fl">0.25</span> <span class="op">*</span> <span class="va">Y_1_0_1</span> <span class="op">+</span> <span class="op">-</span><span class="fl">0.25</span> <span class="op">*</span> <span class="va">Y_1_1_0</span> <span class="op">+</span> <span class="fl">0.25</span> <span class="op">*</span> </span>
<span>    <span class="va">Y_1_1_1</span><span class="op">)</span>, te_T2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.25</span> <span class="op">*</span> <span class="va">Y_0_0_0</span> <span class="op">+</span> <span class="op">-</span><span class="fl">0.25</span> <span class="op">*</span> <span class="va">Y_0_0_1</span> <span class="op">+</span> </span>
<span>    <span class="fl">0.25</span> <span class="op">*</span> <span class="va">Y_0_1_0</span> <span class="op">+</span> <span class="fl">0.25</span> <span class="op">*</span> <span class="va">Y_0_1_1</span> <span class="op">+</span> <span class="op">-</span><span class="fl">0.25</span> <span class="op">*</span> <span class="va">Y_1_0_0</span> <span class="op">+</span> <span class="op">-</span><span class="fl">0.25</span> <span class="op">*</span> </span>
<span>    <span class="va">Y_1_0_1</span> <span class="op">+</span> <span class="fl">0.25</span> <span class="op">*</span> <span class="va">Y_1_1_0</span> <span class="op">+</span> <span class="fl">0.25</span> <span class="op">*</span> <span class="va">Y_1_1_1</span><span class="op">)</span>, `te_T2:T3` <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="fl">0.5</span> <span class="op">*</span> </span>
<span>    <span class="va">Y_0_0_0</span> <span class="op">+</span> <span class="op">-</span><span class="fl">0.5</span> <span class="op">*</span> <span class="va">Y_0_0_1</span> <span class="op">+</span> <span class="op">-</span><span class="fl">0.5</span> <span class="op">*</span> <span class="va">Y_0_1_0</span> <span class="op">+</span> <span class="fl">0.5</span> <span class="op">*</span> <span class="va">Y_0_1_1</span> <span class="op">+</span> </span>
<span>    <span class="fl">0.5</span> <span class="op">*</span> <span class="va">Y_1_0_0</span> <span class="op">+</span> <span class="op">-</span><span class="fl">0.5</span> <span class="op">*</span> <span class="va">Y_1_0_1</span> <span class="op">+</span> <span class="op">-</span><span class="fl">0.5</span> <span class="op">*</span> <span class="va">Y_1_1_0</span> <span class="op">+</span> <span class="fl">0.5</span> <span class="op">*</span> <span class="va">Y_1_1_1</span><span class="op">)</span>, </span>
<span>    te_T1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.25</span> <span class="op">*</span> <span class="va">Y_0_0_0</span> <span class="op">+</span> <span class="op">-</span><span class="fl">0.25</span> <span class="op">*</span> <span class="va">Y_0_0_1</span> <span class="op">+</span> <span class="op">-</span><span class="fl">0.25</span> <span class="op">*</span> </span>
<span>        <span class="va">Y_0_1_0</span> <span class="op">+</span> <span class="op">-</span><span class="fl">0.25</span> <span class="op">*</span> <span class="va">Y_0_1_1</span> <span class="op">+</span> <span class="fl">0.25</span> <span class="op">*</span> <span class="va">Y_1_0_0</span> <span class="op">+</span> <span class="fl">0.25</span> <span class="op">*</span> <span class="va">Y_1_0_1</span> <span class="op">+</span> </span>
<span>        <span class="fl">0.25</span> <span class="op">*</span> <span class="va">Y_1_1_0</span> <span class="op">+</span> <span class="fl">0.25</span> <span class="op">*</span> <span class="va">Y_1_1_1</span><span class="op">)</span>, `te_T1:T3` <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="fl">0.5</span> <span class="op">*</span> </span>
<span>        <span class="va">Y_0_0_0</span> <span class="op">+</span> <span class="op">-</span><span class="fl">0.5</span> <span class="op">*</span> <span class="va">Y_0_0_1</span> <span class="op">+</span> <span class="fl">0.5</span> <span class="op">*</span> <span class="va">Y_0_1_0</span> <span class="op">+</span> <span class="op">-</span><span class="fl">0.5</span> <span class="op">*</span> <span class="va">Y_0_1_1</span> <span class="op">+</span> </span>
<span>        <span class="op">-</span><span class="fl">0.5</span> <span class="op">*</span> <span class="va">Y_1_0_0</span> <span class="op">+</span> <span class="fl">0.5</span> <span class="op">*</span> <span class="va">Y_1_0_1</span> <span class="op">+</span> <span class="op">-</span><span class="fl">0.5</span> <span class="op">*</span> <span class="va">Y_1_1_0</span> <span class="op">+</span> <span class="fl">0.5</span> <span class="op">*</span> </span>
<span>        <span class="va">Y_1_1_1</span><span class="op">)</span>, `te_T1:T2` <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="fl">0.5</span> <span class="op">*</span> <span class="va">Y_0_0_0</span> <span class="op">+</span> <span class="fl">0.5</span> <span class="op">*</span> <span class="va">Y_0_0_1</span> <span class="op">+</span> </span>
<span>        <span class="op">-</span><span class="fl">0.5</span> <span class="op">*</span> <span class="va">Y_0_1_0</span> <span class="op">+</span> <span class="op">-</span><span class="fl">0.5</span> <span class="op">*</span> <span class="va">Y_0_1_1</span> <span class="op">+</span> <span class="op">-</span><span class="fl">0.5</span> <span class="op">*</span> <span class="va">Y_1_0_0</span> <span class="op">+</span> <span class="op">-</span><span class="fl">0.5</span> <span class="op">*</span> </span>
<span>        <span class="va">Y_1_0_1</span> <span class="op">+</span> <span class="fl">0.5</span> <span class="op">*</span> <span class="va">Y_1_1_0</span> <span class="op">+</span> <span class="fl">0.5</span> <span class="op">*</span> <span class="va">Y_1_1_1</span><span class="op">)</span>, `te_T1:T2:T3` <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span> <span class="op">*</span> </span>
<span>        <span class="va">Y_0_0_0</span> <span class="op">+</span> <span class="fl">1</span> <span class="op">*</span> <span class="va">Y_0_0_1</span> <span class="op">+</span> <span class="fl">1</span> <span class="op">*</span> <span class="va">Y_0_1_0</span> <span class="op">+</span> <span class="op">-</span><span class="fl">1</span> <span class="op">*</span> <span class="va">Y_0_1_1</span> <span class="op">+</span> </span>
<span>        <span class="fl">1</span> <span class="op">*</span> <span class="va">Y_1_0_0</span> <span class="op">+</span> <span class="op">-</span><span class="fl">1</span> <span class="op">*</span> <span class="va">Y_1_0_1</span> <span class="op">+</span> <span class="op">-</span><span class="fl">1</span> <span class="op">*</span> <span class="va">Y_1_1_0</span> <span class="op">+</span> <span class="fl">1</span> <span class="op">*</span> <span class="va">Y_1_1_1</span><span class="op">)</span>, </span>
<span>    label <span class="op">=</span> <span class="st">"ATE"</span><span class="op">)</span></span>
<span><span class="va">assignment_factors</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://declaredesign.org/r/declaredesign/reference/declare_assignment.html" class="external-link">declare_assignment</a></span><span class="op">(</span>Z <span class="op">=</span> <span class="fu"><a href="https://declaredesign.org/r/randomizr/reference/complete_ra.html" class="external-link">complete_ra</a></span><span class="op">(</span><span class="va">N</span>, conditions <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="fl">2</span><span class="op">^</span><span class="fl">3</span><span class="op">)</span>, prob_each <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.125</span>, </span>
<span><span class="fl">0.125</span>, <span class="fl">0.125</span>, <span class="fl">0.125</span>, <span class="fl">0.125</span>, <span class="fl">0.125</span>, <span class="fl">0.125</span>, <span class="fl">0.125</span><span class="op">)</span><span class="op">)</span>, Z_cond_prob <span class="op">=</span> <span class="fu"><a href="https://declaredesign.org/r/randomizr/reference/obtain_condition_probabilities.html" class="external-link">obtain_condition_probabilities</a></span><span class="op">(</span>assignment <span class="op">=</span> <span class="va">Z</span>, </span>
<span>    conditions <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="fl">2</span><span class="op">^</span><span class="fl">3</span><span class="op">)</span>, prob_each <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.125</span>, <span class="fl">0.125</span>, <span class="fl">0.125</span>, </span>
<span>    <span class="fl">0.125</span>, <span class="fl">0.125</span>, <span class="fl">0.125</span>, <span class="fl">0.125</span>, <span class="fl">0.125</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">assignment</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://declaredesign.org/r/declaredesign/reference/declare_step.html" class="external-link">declare_step</a></span><span class="op">(</span><span class="va">fabricate</span>, T1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">Z</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2L</span>, <span class="fl">4L</span>, <span class="fl">6L</span>, </span>
<span><span class="fl">8L</span><span class="op">)</span><span class="op">)</span>, T2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">Z</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3L</span>, <span class="fl">4L</span>, <span class="fl">7L</span>, <span class="fl">8L</span><span class="op">)</span><span class="op">)</span>, T3 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">Z</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> </span>
<span>    <span class="fl">5</span><span class="op">:</span><span class="fl">8</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">estimator</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://declaredesign.org/r/declaredesign/reference/declare_estimator.html" class="external-link">declare_estimator</a></span><span class="op">(</span>handler <span class="op">=</span> <span class="fu"><a href="https://declaredesign.org/r/declaredesign/reference/declare_estimator.html" class="external-link">label_estimator</a></span><span class="op">(</span><span class="kw">function</span><span class="op">(</span><span class="va">data</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">data</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"T1"</span>, <span class="st">"T2"</span>, <span class="st">"T3"</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">data</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> </span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"T1"</span>, <span class="st">"T2"</span>, <span class="st">"T3"</span><span class="op">)</span><span class="op">]</span> <span class="op">-</span> <span class="fl">0.5</span></span>
<span>    <span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://declaredesign.org/r/estimatr/reference/lm_robust.html" class="external-link">lm_robust</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="va">Y</span> <span class="op">~</span> <span class="va">T1</span> <span class="op">*</span> <span class="va">T2</span> <span class="op">*</span> <span class="va">T3</span>, data <span class="op">=</span> <span class="va">data</span>, </span>
<span>        weights <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="va">Z_cond_prob</span><span class="op">)</span></span>
<span>    <span class="va">estimate_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span></span>
<span>    <span class="va">estimate_df</span><span class="op">$</span><span class="va">inquiry</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"te_"</span>, <span class="va">estimate_df</span><span class="op">$</span><span class="va">term</span><span class="op">)</span></span>
<span>    <span class="va">estimate_df</span><span class="op">$</span><span class="va">inquiry</span><span class="op">[</span><span class="va">estimate_df</span><span class="op">$</span><span class="va">inquiry</span> <span class="op">==</span> <span class="st">"te_(Intercept)"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"Overall_average"</span></span>
<span>    <span class="va">estimate_df</span></span>
<span><span class="op">}</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">factorial_design</span> <span class="op">&lt;-</span> <span class="va">population</span> <span class="op">+</span> <span class="va">potential_outcomes</span> <span class="op">+</span> <span class="va">assignment_factors</span> <span class="op">+</span> </span>
<span>    <span class="va">assignment</span> <span class="op">+</span> <span class="va">reveal_Y</span> <span class="op">+</span> <span class="va">estimand</span> <span class="op">+</span> <span class="va">estimator</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="takeaways">Takeaways<a class="anchor" aria-label="anchor" href="#takeaways"></a>
</h2>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">diagnosis</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://declaredesign.org/r/declaredesign/reference/diagnose_design.html" class="external-link">diagnose_design</a></span><span class="op">(</span><span class="va">factorial_design</span>, sims <span class="op">=</span> <span class="fl">25</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: We recommend you choose a number of simulations higher than 30.</span></span></code></pre>
<table style="width:100%;" class="table">
<colgroup>
<col width="12%">
<col width="11%">
<col width="7%">
<col width="5%">
<col width="8%">
<col width="4%">
<col width="9%">
<col width="9%">
<col width="4%">
<col width="8%">
<col width="4%">
<col width="4%">
<col width="6%">
</colgroup>
<thead><tr class="header">
<th align="left">Design</th>
<th align="left">Inquiry</th>
<th align="left">Estimator</th>
<th align="left">Outcome</th>
<th align="left">Term</th>
<th align="left">N Sims</th>
<th align="left">Mean Estimand</th>
<th align="left">Mean Estimate</th>
<th align="left">Bias</th>
<th align="left">SD Estimate</th>
<th align="left">RMSE</th>
<th align="left">Power</th>
<th align="left">Coverage</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">factorial_design</td>
<td align="left">Overall_average</td>
<td align="left">estimator</td>
<td align="left">Y</td>
<td align="left">(Intercept)</td>
<td align="left">25</td>
<td align="left">0.00</td>
<td align="left">0.00</td>
<td align="left">0.00</td>
<td align="left">0.06</td>
<td align="left">0.06</td>
<td align="left">0.08</td>
<td align="left">0.92</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left">(0.00)</td>
<td align="left">(0.01)</td>
<td align="left">(0.01)</td>
<td align="left">(0.01)</td>
<td align="left">(0.01)</td>
<td align="left">(0.06)</td>
<td align="left">(0.06)</td>
</tr>
<tr class="odd">
<td align="left">factorial_design</td>
<td align="left">te_T1</td>
<td align="left">estimator</td>
<td align="left">Y</td>
<td align="left">T1</td>
<td align="left">25</td>
<td align="left">-0.01</td>
<td align="left">0.02</td>
<td align="left">0.03</td>
<td align="left">0.09</td>
<td align="left">0.10</td>
<td align="left">0.00</td>
<td align="left">1.00</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left">(0.01)</td>
<td align="left">(0.02)</td>
<td align="left">(0.02)</td>
<td align="left">(0.01)</td>
<td align="left">(0.01)</td>
<td align="left">(0.00)</td>
<td align="left">(0.00)</td>
</tr>
<tr class="odd">
<td align="left">factorial_design</td>
<td align="left">te_T1:T2</td>
<td align="left">estimator</td>
<td align="left">Y</td>
<td align="left">T1:T2</td>
<td align="left">25</td>
<td align="left">0.01</td>
<td align="left">0.02</td>
<td align="left">0.01</td>
<td align="left">0.25</td>
<td align="left">0.23</td>
<td align="left">0.00</td>
<td align="left">1.00</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left">(0.01)</td>
<td align="left">(0.05)</td>
<td align="left">(0.05)</td>
<td align="left">(0.02)</td>
<td align="left">(0.02)</td>
<td align="left">(0.00)</td>
<td align="left">(0.00)</td>
</tr>
<tr class="odd">
<td align="left">factorial_design</td>
<td align="left">te_T1:T2:T3</td>
<td align="left">estimator</td>
<td align="left">Y</td>
<td align="left">T1:T2:T3</td>
<td align="left">25</td>
<td align="left">-0.03</td>
<td align="left">0.15</td>
<td align="left">0.18</td>
<td align="left">0.41</td>
<td align="left">0.43</td>
<td align="left">0.04</td>
<td align="left">1.00</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left">(0.03)</td>
<td align="left">(0.08)</td>
<td align="left">(0.07)</td>
<td align="left">(0.08)</td>
<td align="left">(0.06)</td>
<td align="left">(0.04)</td>
<td align="left">(0.00)</td>
</tr>
<tr class="odd">
<td align="left">factorial_design</td>
<td align="left">te_T1:T3</td>
<td align="left">estimator</td>
<td align="left">Y</td>
<td align="left">T1:T3</td>
<td align="left">25</td>
<td align="left">0.01</td>
<td align="left">-0.03</td>
<td align="left">-0.05</td>
<td align="left">0.26</td>
<td align="left">0.26</td>
<td align="left">0.08</td>
<td align="left">0.96</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left">(0.02)</td>
<td align="left">(0.05)</td>
<td align="left">(0.05)</td>
<td align="left">(0.04)</td>
<td align="left">(0.03)</td>
<td align="left">(0.05)</td>
<td align="left">(0.04)</td>
</tr>
<tr class="odd">
<td align="left">factorial_design</td>
<td align="left">te_T2</td>
<td align="left">estimator</td>
<td align="left">Y</td>
<td align="left">T2</td>
<td align="left">25</td>
<td align="left">-0.01</td>
<td align="left">-0.02</td>
<td align="left">-0.01</td>
<td align="left">0.10</td>
<td align="left">0.10</td>
<td align="left">0.00</td>
<td align="left">1.00</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left">(0.01)</td>
<td align="left">(0.02)</td>
<td align="left">(0.02)</td>
<td align="left">(0.01)</td>
<td align="left">(0.01)</td>
<td align="left">(0.00)</td>
<td align="left">(0.00)</td>
</tr>
<tr class="odd">
<td align="left">factorial_design</td>
<td align="left">te_T2:T3</td>
<td align="left">estimator</td>
<td align="left">Y</td>
<td align="left">T2:T3</td>
<td align="left">25</td>
<td align="left">-0.01</td>
<td align="left">-0.03</td>
<td align="left">-0.03</td>
<td align="left">0.32</td>
<td align="left">0.27</td>
<td align="left">0.08</td>
<td align="left">0.92</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left">(0.02)</td>
<td align="left">(0.07)</td>
<td align="left">(0.06)</td>
<td align="left">(0.03)</td>
<td align="left">(0.03)</td>
<td align="left">(0.06)</td>
<td align="left">(0.06)</td>
</tr>
<tr class="odd">
<td align="left">factorial_design</td>
<td align="left">te_T3</td>
<td align="left">estimator</td>
<td align="left">Y</td>
<td align="left">T3</td>
<td align="left">25</td>
<td align="left">0.01</td>
<td align="left">0.02</td>
<td align="left">0.01</td>
<td align="left">0.12</td>
<td align="left">0.11</td>
<td align="left">0.04</td>
<td align="left">0.96</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left">(0.01)</td>
<td align="left">(0.02)</td>
<td align="left">(0.02)</td>
<td align="left">(0.02)</td>
<td align="left">(0.02)</td>
<td align="left">(0.04)</td>
<td align="left">(0.04)</td>
</tr>
</tbody>
</table>
<ul>
<li>We see that the space of estimands we can estimate is amazingly rich, but our power to do so is very low.</li>
</ul>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Graeme Blair, Jasper Cooper, Alexander Coppock, Macartan Humphreys, Clara Bicalho, Neal Fultz, Lily Medina.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
