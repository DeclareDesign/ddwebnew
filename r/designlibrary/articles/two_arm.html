<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="DesignLibrary">
<title>Two-Arm Experiment • DesignLibrary</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Two-Arm Experiment">
<meta property="og:description" content="DesignLibrary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">DesignLibrary</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.1.10</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/How_to_Write_and_Contribute_Designers.html">How to Write and Contribute Designers</a>
    <a class="dropdown-item" href="../articles/How_to_Write_and_Contribute_Designs.html">How to Write and Contribute Designs</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-software">Software</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-software">
    <a class="external-link dropdown-item" href="http://declaredesign.org/r/declaredesign/">DeclareDesign</a>
    <a class="external-link dropdown-item" href="https://declaredesign.org/r/randomizr/">randomizr</a>
    <a class="external-link dropdown-item" href="https://declaredesign.org/r/fabricatr/">fabricatr</a>
    <a class="external-link dropdown-item" href="https://declaredesign.org/r/estimatr/">estimatr</a>
    <a class="dropdown-item" href="https://declaredesign.org/r/designlibrary/">DesignLibrary</a>
    <a class="external-link dropdown-item" href="https://eos.wzb.eu/ipi/DDWizard/">DesignWizard</a>
  </div>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://declaredesign.org">declaredesign.org</a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">



<script src="two_arm_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Two-Arm Experiment</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/DeclareDesign/DesignLibrary/blob/HEAD/../vignettes/two_arm.Rmd" class="external-link"><code>../vignettes/two_arm.Rmd</code></a></small>
      <div class="d-none name"><code>two_arm.Rmd</code></div>
    </div>

    
    
<p>One of the simplest ways to learn about the effect of a cause is to randomly divide a group in two: one gets a treatment and the other doesn’t. By comparing the averages of the outcomes in the treatment group to those of the control group, you get to learn about the causal effect of the treatment – at least on average. Magic.</p>
<p>So how does it work? In fact, it works only if we are willing to make a few assumptions. First, for each individual in our study, we are willing to imagine two counterfactuals: one in which they ended up in the treatment group, and one where they ended up in the control. We’ll define the unit level treatment effect as the difference between these two. Second, we’ll assume that an individual’s outcome is not affected by whoever else did or did not end up in their group.<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;This is often referred to as the “no spillovers” assumption. An individual’s outcome depends only on their treatment assignment status and is not affected by that of any other individual.&lt;/p&gt;"><sup>1</sup></a></p>
<p>Ideally, we’d like to observe both counterfactuals for each individual, and we’d know the true causal effect by looking at the differences. But we can’t see the world in two counterfactual states at once: that’s called the fundamental problem of causal inference.</p>
<p>Amazingly though, while we can never learn the true causal effect of an individual, we <em>can</em> learn about the true causal effect <em>averaged across groups of individuals</em>. The basis for that inference shares an interesting parallel with random sampling.</p>
<p>When we take a random sample from a population, the sample becomes representative of the population in the sense that the average outcome in the sample will, on average, be the same as the average outcome in the population. Technically: the procedure delivers unbiased estimates of averages. In an experiment, it’s as though we’re taking two separate representative samples from <em>two counterfactual states of the world</em>, one from a world in which the cause is present and one from one in which it is absent. By taking the mean of the group that represents the treated potential outcomes and comparing it to the mean of the group that represents the untreated potential outcomes, we can construct an unbiased guess of the true average difference in the two states of the world.<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;This last step used the useful fact that the difference of averages is the same as the average of differences.&lt;/p&gt;"><sup>2</sup></a></p>
<p>This logic does not guarantee that an answer is <em>correct.</em> A two arm trial does not let us <em>see</em> the true treatment effect. But it does produce an estimate that is not biased up or down. Just like in random sampling, as the size of our experiment grows, our guess of the average treatment effect (ATE) will converge to the true ATE. As we shall see, however, characterizing our uncertainty about our guesses can be complicated, even in such a simple design.</p>
<div class="section level2">
<h2 id="design-declaration">Design Declaration<a class="anchor" aria-label="anchor" href="#design-declaration"></a>
</h2>
<ul>
<li>
<p><strong>M</strong>odel:</p>
<p>Our model of the world specifies a population of <span class="math inline">\(N\)</span> units that have a control potential outcome, <span class="math inline">\(Y_i(Z = 0)\)</span>, that is distributed standard normally. A unit’s individual treatment effect is a random draw from a distribution with mean <span class="math inline">\(\tau\)</span> and standard deviation <span class="math inline">\(\sigma\)</span>, that is added to its control potential outcome: <span class="math inline">\(Y_i(Z = 1) = Y_i(Z = 0) + t_i\)</span>.<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;This implies that the variance of the sample’s treated potential outcomes is higher than the variance of their control potential outcomes, although they are correlated because the treated potential outcome is created by simply adding the treatment effect to the control potential outcome.&lt;/p&gt;"><sup>3</sup></a></p>
</li>
<li>
<p><strong>I</strong>nquiry:</p>
<p>We want to know the average of all units’ differences in treated and untreated potential outcomes – the average treatment effect: <span class="math inline">\(E[Y_i(Z = 1) - Y_i(Z = 0)] = E[t_i] = \tau\)</span>.</p>
</li>
<li>
<p><strong>D</strong>ata strategy:</p>
<p>We randomly sample <span class="math inline">\(n\)</span> units from the population of <span class="math inline">\(N\)</span>. We randomly assign a fixed number, <span class="math inline">\(m\)</span>, to treatment, and the rest of the <span class="math inline">\(n-m\)</span> units to control.</p>
</li>
<li>
<p><strong>A</strong>nswer strategy:</p>
<p>We subtract the mean of the control group from the mean of the treatment group in order to estimate the average treatment effect. <span class="math inline">\(E[Y_i(Z = 1)] - E[Y_i(Z = 0)] = \hat{\tau}\)</span>.</p>
</li>
</ul>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">N</span> <span class="op">&lt;-</span> <span class="fl">100</span></span>
<span><span class="va">assignment_prob</span> <span class="op">&lt;-</span> <span class="fl">0.5</span></span>
<span><span class="va">control_mean</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">control_sd</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span><span class="va">treatment_mean</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span><span class="va">treatment_sd</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span><span class="va">rho</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span></span>
<span><span class="va">population</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://declaredesign.org/r/declaredesign/reference/declare_population.html" class="external-link">declare_population</a></span><span class="op">(</span>N <span class="op">=</span> <span class="va">N</span>, u_0 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">N</span><span class="op">)</span>, u_1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="va">N</span>, </span>
<span>    mean <span class="op">=</span> <span class="va">rho</span> <span class="op">*</span> <span class="va">u_0</span>, sd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">rho</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">potential_outcomes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://declaredesign.org/r/declaredesign/reference/declare_potential_outcomes.html" class="external-link">declare_potential_outcomes</a></span><span class="op">(</span><span class="va">Y</span> <span class="op">~</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> </span>
<span>    <span class="va">Z</span><span class="op">)</span> <span class="op">*</span> <span class="op">(</span><span class="va">u_0</span> <span class="op">*</span> <span class="va">control_sd</span> <span class="op">+</span> <span class="va">control_mean</span><span class="op">)</span> <span class="op">+</span> <span class="va">Z</span> <span class="op">*</span> <span class="op">(</span><span class="va">u_1</span> <span class="op">*</span> <span class="va">treatment_sd</span> <span class="op">+</span> </span>
<span>    <span class="va">treatment_mean</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">estimand</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://declaredesign.org/r/declaredesign/reference/declare_inquiry.html" class="external-link">declare_inquiry</a></span><span class="op">(</span>ATE <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">Y_Z_1</span> <span class="op">-</span> <span class="va">Y_Z_0</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">assignment</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://declaredesign.org/r/declaredesign/reference/declare_assignment.html" class="external-link">declare_assignment</a></span><span class="op">(</span>Z <span class="op">=</span> <span class="fu"><a href="https://declaredesign.org/r/randomizr/reference/complete_ra.html" class="external-link">complete_ra</a></span><span class="op">(</span><span class="va">N</span>, prob <span class="op">=</span> <span class="va">assignment_prob</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">reveal_Y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://declaredesign.org/r/declaredesign/reference/declare_reveal.html" class="external-link">declare_reveal</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">estimator</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://declaredesign.org/r/declaredesign/reference/declare_estimator.html" class="external-link">declare_estimator</a></span><span class="op">(</span><span class="va">Y</span> <span class="op">~</span> <span class="va">Z</span>, inquiry <span class="op">=</span> <span class="va">estimand</span><span class="op">)</span></span>
<span><span class="va">two_arm_design</span> <span class="op">&lt;-</span> <span class="va">population</span> <span class="op">+</span> <span class="va">potential_outcomes</span> <span class="op">+</span> <span class="va">estimand</span> <span class="op">+</span> </span>
<span>    <span class="va">assignment</span> <span class="op">+</span> <span class="va">reveal_Y</span> <span class="op">+</span> <span class="va">estimator</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="takeaways">Takeaways<a class="anchor" aria-label="anchor" href="#takeaways"></a>
</h2>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">diagnosis</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://declaredesign.org/r/declaredesign/reference/diagnose_design.html" class="external-link">diagnose_design</a></span><span class="op">(</span><span class="va">two_arm_design</span>, sims <span class="op">=</span> <span class="fl">25</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: We recommend you choose a number of simulations higher than 30.</span></span></code></pre>
<table class="table">
<thead><tr class="header">
<th align="left">Outcome</th>
<th align="left">N Sims</th>
<th align="left">Mean Estimand</th>
<th align="left">Mean Estimate</th>
<th align="left">Bias</th>
<th align="left">SD Estimate</th>
<th align="left">RMSE</th>
<th align="left">Power</th>
<th align="left">Coverage</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Y</td>
<td align="left">25</td>
<td align="left">1.00</td>
<td align="left">1.05</td>
<td align="left">0.05</td>
<td align="left">0.22</td>
<td align="left">0.22</td>
<td align="left">1.00</td>
<td align="left">0.88</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left">(0.00)</td>
<td align="left">(0.04)</td>
<td align="left">(0.04)</td>
<td align="left">(0.04)</td>
<td align="left">(0.04)</td>
<td align="left">(0.00)</td>
<td align="left">(0.06)</td>
</tr>
</tbody>
</table>
<ul>
<li>As the diagnosis reveals, the estimate of the ATE is unbiased. We could have shown this without simulations using simple algebra. Our estimator, <span class="math inline">\(\hat{\tau}\)</span>, can be written <span class="math inline">\(E[Y_i(Z = 1)] - E[Y_i(Z = 0)] = E[Y_i(Z = 1) - Y_i(Z = 0)]\)</span> (via “the linearity of expectation”). Note this implies <span class="math inline">\(\tau = \hat{\tau}\)</span>: our estimand is equivalent to our estimator in expectation.</li>
<li>But our coverage is above what it should be (95%) This over-coverage reflects the fact that estimators of the standard error for the difference make a worst-case assumption about the covariance of potential outcomes. This conservative approach leads to standard error estimates that overstate the true variation in the sampling distribution of the point estimator.</li>
</ul>
</div>
<div class="section level2">
<h2 id="exercises">Exercises<a class="anchor" aria-label="anchor" href="#exercises"></a>
</h2>
<ol style="list-style-type: decimal">
<li><p>Using the <code><a href="../reference/two_arm_designer.html">two_arm_designer()</a></code>, declare a set of designs in which the correlation in potential outcomes goes from negative, to zero, to positive. What do you notice about the coverage? Explain with reference to the mean standard error and the standard deviation of the estimates.</p></li>
<li><p>Modify the assignment step in the design so that individuals’ probability of assignment is a function of <code>u_0</code>, but don’t change anything else. What do you notice about the diagnosands of the design now? How might you change the estimation strategy to account for this updated assignment strategy?</p></li>
</ol>
</div>

  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Graeme Blair, Jasper Cooper, Alexander Coppock, Macartan Humphreys, Clara Bicalho, Neal Fultz, Lily Medina.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
