<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Builds a two-arm design with blocks and clusters."><title>Create a two-arm design with blocks and clusters — block_cluster_two_arm_designer • DesignLibrary</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Create a two-arm design with blocks and clusters — block_cluster_two_arm_designer"><meta property="og:description" content="Builds a two-arm design with blocks and clusters."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">DesignLibrary</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.1.10</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/How_to_Write_and_Contribute_Designers.html">How to Write and Contribute Designers</a>
    <a class="dropdown-item" href="../articles/How_to_Write_and_Contribute_Designs.html">How to Write and Contribute Designs</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-software">Software</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-software">
    <a class="external-link dropdown-item" href="http://declaredesign.org/r/declaredesign/">DeclareDesign</a>
    <a class="external-link dropdown-item" href="https://declaredesign.org/r/randomizr/">randomizr</a>
    <a class="external-link dropdown-item" href="https://declaredesign.org/r/fabricatr/">fabricatr</a>
    <a class="external-link dropdown-item" href="https://declaredesign.org/r/estimatr/">estimatr</a>
    <a class="dropdown-item" href="https://declaredesign.org/r/designlibrary/">DesignLibrary</a>
    <a class="external-link dropdown-item" href="https://eos.wzb.eu/ipi/DDWizard/">DesignWizard</a>
  </div>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://declaredesign.org">declaredesign.org</a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Create a two-arm design with blocks and clusters</h1>
      <small class="dont-index">Source: <a href="https://github.com/DeclareDesign/DesignLibrary/blob/HEAD/R/block_cluster_two_arm_designer.R" class="external-link"><code>R/block_cluster_two_arm_designer.R</code></a></small>
      <div class="d-none name"><code>block_cluster_two_arm_designer.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Builds a two-arm design with blocks and clusters.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">block_cluster_two_arm_designer</span><span class="op">(</span></span>
<span>  N <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  N_blocks <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  N_clusters_in_block <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">N</span><span class="op">)</span>, <span class="fl">100</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">N</span><span class="op">/</span><span class="va">N_blocks</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  N_i_in_cluster <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">N</span><span class="op">)</span>, <span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">N</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">N_blocks</span> <span class="op">*</span> <span class="va">N_clusters_in_block</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  sd <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  sd_block <span class="op">=</span> <span class="fl">0.5773</span> <span class="op">*</span> <span class="va">sd</span>,</span>
<span>  sd_cluster <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fl">0</span>, <span class="op">(</span><span class="va">sd</span><span class="op">^</span><span class="fl">2</span> <span class="op">-</span> <span class="va">sd_block</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span><span class="op">^</span><span class="fl">0.5</span>,</span>
<span>  sd_i_0 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">sd</span><span class="op">^</span><span class="fl">2</span> <span class="op">-</span> <span class="va">sd_block</span><span class="op">^</span><span class="fl">2</span> <span class="op">-</span> <span class="va">sd_cluster</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">^</span><span class="fl">0.5</span>,</span>
<span>  sd_i_1 <span class="op">=</span> <span class="va">sd_i_0</span>,</span>
<span>  rho <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  assignment_probs <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  control_mean <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  ate <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  treatment_mean <span class="op">=</span> <span class="va">control_mean</span> <span class="op">+</span> <span class="va">ate</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  args_to_fix <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>N</dt>
<dd><p>An integer. Total number of units. Usually not specified as <code>N</code> is determined by <code>N_blocks</code>, <code>N_clusters_in_block</code>, and <code>N_i_in_cluster</code>. If <code>N_blocks</code>, and  <code>N_clusters_in_block</code>, and <code>N_i_in_cluster</code> are specified then <code>N</code> is overridden. If these are not specified and <code>N</code> is specified then designer attempts to guess sizes of levels to approximate <code>N</code>, with preference for a design without blocks or clusters.</p></dd>


<dt>N_blocks</dt>
<dd><p>An integer. Number of blocks. Defaults to 1 for no blocks.</p></dd>


<dt>N_clusters_in_block</dt>
<dd><p>An integer or vector of integers of length <code>N_blocks</code>. Number of clusters in each block. This is the total <code>N</code> when <code>N_blocks</code> and <code>N_i_in_cluster</code> are at default values.</p></dd>


<dt>N_i_in_cluster</dt>
<dd><p>An integer or vector of integers of length <code>sum(N_clusters_in_block)</code>. Individuals per cluster. Defaults to 1 for no clusters.</p></dd>


<dt>sd</dt>
<dd><p>A nonnegative number. Overall standard deviation (combining individual level, cluster level, and block level shocks). Defaults to 1. Overridden if incompatible with other user-specified shocks.</p></dd>


<dt>sd_block</dt>
<dd><p>A nonnegative number. Standard deviation of block level shocks.</p></dd>


<dt>sd_cluster</dt>
<dd><p>A nonnegative number. Standard deviation of cluster level shock.</p></dd>


<dt>sd_i_0</dt>
<dd><p>A nonnegative number. Standard deviation of individual level shock in control. If not specified, and when possible given <code>sd_block</code> and <code>sd_cluster</code>, <code>sd_i_0</code> defaults to make total variance = sd.</p></dd>


<dt>sd_i_1</dt>
<dd><p>A nonnegative number. Standard deviation of individual level shock in treatment. Defaults to <code>sd_i_0</code>.</p></dd>


<dt>rho</dt>
<dd><p>A number in [-1,1]. Correlation in individual shock between potential outcomes for treatment and control.</p></dd>


<dt>assignment_probs</dt>
<dd><p>A number or vector of numbers in (0,1). Treatment assignment probability for each block (specified in order of <code>N_clusters_in_block</code>).</p></dd>


<dt>control_mean</dt>
<dd><p>A number. Average outcome in control.</p></dd>


<dt>ate</dt>
<dd><p>A number. Average treatment effect. Alternative to specifying <code>treatment_mean</code>. Note that <code>ate</code> is an argument for the designer but it does not appear as an argument in design code (design code uses <code>control_mean</code> and <code>treatment_mean</code> only).</p></dd>


<dt>treatment_mean</dt>
<dd><p>A number. Average outcome in treatment. If <code>treatment_mean</code> is not provided then it is calculated as <code>control_mean + ate</code>. If both <code>ate</code> and  <code>treatment_mean</code> are provided then only  <code>treatment_mean</code> is used.</p></dd>


<dt>verbose</dt>
<dd><p>Logical. If TRUE, prints intra-cluster correlation implied by design parameters.</p></dd>


<dt>args_to_fix</dt>
<dd><p>A character vector. Names of arguments to be args_to_fix in design.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>A block cluster two-arm design.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Units are assigned to treatment using complete block cluster random assignment. Treatment effects can be specified either by providing <code>control_mean</code> and <code>treatment_mean</code>
or by specifying an <code>ate</code>. Estimation uses differences in means accounting for blocks and clusters.</p>
<p>In the usual case <code>N</code> is not provided by the user but is determined by <code>N_blocks</code>, <code>N_clusters_in_block</code>, <code>N_i_in_cluster</code> (when these are integers <code>N</code> is the product of these three numbers).</p>
<p>Normal shocks can be specified at the individual, cluster, and block levels. If individual level shocks are not specified and cluster and block 
level variances sum to less than 1, then individual level shocks are set such that total variance in outcomes equals 1.</p>
<p>Key limitations: The designer assumes covariance between potential outcomes at the individual level only.</p>
<p>See <a href="https://declaredesign.org/r/designlibrary/articles/block_cluster_two_arm.html">vignette online</a>.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p><a href="https://declaredesign.org/" class="external-link">DeclareDesign Team</a></p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Generate a design using default arguments:</span></span></span>
<span class="r-in"><span><span class="va">block_cluster_two_arm_design</span> <span class="op">&lt;-</span> <span class="fu">block_cluster_two_arm_designer</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "The implied ICC in (control) is 0.667"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "The implied ICC in (control) conditional on block is  0.5"</span>
<span class="r-in"><span><span class="va">block_cluster_uneven</span> <span class="op">&lt;-</span> <span class="fu">block_cluster_two_arm_designer</span><span class="op">(</span></span></span>
<span class="r-in"><span>       N_blocks <span class="op">=</span> <span class="fl">3</span>, N_clusters_in_block <span class="op">=</span> <span class="fl">2</span><span class="op">:</span><span class="fl">4</span>, N_i_in_cluster <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">9</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "The implied ICC in (control) is 0.667"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "The implied ICC in (control) conditional on block is  0.5"</span>
<span class="r-in"><span><span class="co"># A design in which number of clusters of cluster size is not specified</span></span></span>
<span class="r-in"><span><span class="co"># but N and block size are:        </span></span></span>
<span class="r-in"><span><span class="va">block_cluster_guess</span> <span class="op">&lt;-</span> <span class="fu">block_cluster_two_arm_designer</span><span class="op">(</span>N <span class="op">=</span> <span class="fl">24</span>, N_blocks <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "The implied ICC in (control) is 0.667"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "The implied ICC in (control) conditional on block is  0.5"</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Graeme Blair, Jasper Cooper, Alexander Coppock, Macartan Humphreys, Clara Bicalho, Neal Fultz, Lily Medina.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

