<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Difference-in-means estimators that selects the appropriate
point estimate, standard errors, and degrees of freedom for a variety of
designs: unit randomized, cluster randomized, block randomized,
block-cluster randomized, matched-pairs, and matched-pair cluster
randomized designs"><title>Design-based difference-in-means estimator — difference_in_means • estimatr</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Design-based difference-in-means estimator — difference_in_means"><meta property="og:description" content="Difference-in-means estimators that selects the appropriate
point estimate, standard errors, and degrees of freedom for a variety of
designs: unit randomized, cluster randomized, block randomized,
block-cluster randomized, matched-pairs, and matched-pair cluster
randomized designs"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">estimatr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">1.0.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/getting-started.html">Getting started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/getting-started.html">Getting started using estimatr</a>
    <a class="dropdown-item" href="../articles/absorbing-fixed-effects.html">Absorbing Fixed Effects with estimatr</a>
    <a class="dropdown-item" href="../articles/estimatr-in-the-tidyverse.html">estimatr in the Tidyverse</a>
    <a class="dropdown-item" href="../articles/benchmarking-estimatr.html">Benchmarking estimatr</a>
    <a class="dropdown-item" href="../articles/emmeans-examples.html">Examples with emmeans</a>
    <a class="dropdown-item" href="../articles/mathematical-notes.html">Mathematical notes for estimatr</a>
    <a class="dropdown-item" href="../articles/regression-tables.html">Regression Tables with estimatr</a>
    <a class="dropdown-item" href="../articles/simulations-debiasing-dim.html">Simulations - Debiasing Difference-in-Means</a>
    <a class="dropdown-item" href="../articles/simulations-ols-variance.html">Simulations - OLS and Variance</a>
    <a class="dropdown-item" href="../articles/stata-wls-hat.html">How Stata's hat matrix differs with weights</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-software">Software</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-software">
    <a class="external-link dropdown-item" href="http://declaredesign.org/r/declaredesign/">DeclareDesign</a>
    <a class="external-link dropdown-item" href="https://declaredesign.org/r/randomizr/">randomizr</a>
    <a class="external-link dropdown-item" href="https://declaredesign.org/r/fabricatr/">fabricatr</a>
    <a class="dropdown-item" href="https://declaredesign.org/r/estimatr/">estimatr</a>
    <a class="external-link dropdown-item" href="https://declaredesign.org/r/designlibrary/">DesignLibrary</a>
    <a class="external-link dropdown-item" href="https://eos.wzb.eu/ipi/DDWizard/">DesignWizard</a>
  </div>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://declaredesign.org">declaredesign.org</a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Design-based difference-in-means estimator</h1>
      <small class="dont-index">Source: <a href="https://github.com/DeclareDesign/estimatr/blob/HEAD/R/estimatr_difference_in_means.R" class="external-link"><code>R/estimatr_difference_in_means.R</code></a></small>
      <div class="d-none name"><code>difference_in_means.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Difference-in-means estimators that selects the appropriate
point estimate, standard errors, and degrees of freedom for a variety of
designs: unit randomized, cluster randomized, block randomized,
block-cluster randomized, matched-pairs, and matched-pair cluster
randomized designs</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">difference_in_means</span><span class="op">(</span></span>
<span>  <span class="va">formula</span>,</span>
<span>  <span class="va">data</span>,</span>
<span>  <span class="va">blocks</span>,</span>
<span>  <span class="va">clusters</span>,</span>
<span>  <span class="va">weights</span>,</span>
<span>  <span class="va">subset</span>,</span>
<span>  se_type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"default"</span>, <span class="st">"none"</span><span class="op">)</span>,</span>
<span>  condition1 <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  condition2 <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  ci <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">0.05</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>formula</dt>
<dd><p>an object of class formula, as in <code><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></code>, such as
<code>Y ~ Z</code> with only one variable on the right-hand side, the treatment.</p></dd>


<dt>data</dt>
<dd><p>A <code>data.frame</code>.</p></dd>


<dt>blocks</dt>
<dd><p>An optional bare (unquoted) name of the block variable. Use
for blocked designs only.</p></dd>


<dt>clusters</dt>
<dd><p>An optional bare (unquoted) name of the variable that
corresponds to the clusters in the data; used for cluster randomized
designs. For blocked designs, clusters must nest within blocks.</p></dd>


<dt>weights</dt>
<dd><p>the bare (unquoted) names of the weights variable in the
supplied data.</p></dd>


<dt>subset</dt>
<dd><p>An optional bare (unquoted) expression specifying a subset of
observations to be used.</p></dd>


<dt>se_type</dt>
<dd><p>An optional string that can be one of <code>c("default", "none")</code>. If "default" (the default), it will use the default standard error estimator for the design, and if "none" then standard errors will not be computed which may speed up run time if only the point estimate is required.</p></dd>


<dt>condition1</dt>
<dd><p>value in the treatment vector of the condition
to be the control. Effects are
estimated with <code>condition1</code> as the control and <code>condition2</code> as the
treatment. If unspecified, <code>condition1</code> is the "first" condition and
<code>condition2</code> is the "second" according to levels if the treatment is a
factor or according to a sortif it is a numeric or character variable (i.e
if unspecified and the treatment is 0s and 1s, <code>condition1</code> will by
default be 0 and <code>condition2</code> will be 1). See the examples for more.</p></dd>


<dt>condition2</dt>
<dd><p>value in the treatment vector of the condition to be the
treatment. See <code>condition1</code>.</p></dd>


<dt>ci</dt>
<dd><p>logical. Whether to compute and return p-values and
confidence intervals, TRUE by default.</p></dd>


<dt>alpha</dt>
<dd><p>The significance level, 0.05 by default.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>Returns an object of class <code>"difference_in_means"</code>.</p>


<p>The post-estimation commands functions <code>summary</code> and <code><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy</a></code></p>


<p>return results in a <code>data.frame</code>. To get useful data out of the return,
you can use these data frames, you can use the resulting list directly, or
you can use the generic accessor functions <code>coef</code> and
<code>confint</code>.</p>


<p>An object of class <code>"difference_in_means"</code> is a list containing at
least the following components:</p>
<dl><dt>coefficients</dt>
<dd><p>the estimated difference in means</p></dd>

  <dt>std.error</dt>
<dd><p>the estimated standard error</p></dd>

  <dt>statistic</dt>
<dd><p>the t-statistic</p></dd>

  <dt>df</dt>
<dd><p>the estimated degrees of freedom</p></dd>

  <dt>p.value</dt>
<dd><p>the p-value from a two-sided t-test using <code>coefficients</code>, <code>std.error</code>, and <code>df</code></p></dd>

  <dt>conf.low</dt>
<dd><p>the lower bound of the <code>1 - alpha</code> percent confidence interval</p></dd>

  <dt>conf.high</dt>
<dd><p>the upper bound of the <code>1 - alpha</code> percent confidence interval</p></dd>

  <dt>term</dt>
<dd><p>a character vector of coefficient names</p></dd>

  <dt>alpha</dt>
<dd><p>the significance level specified by the user</p></dd>

  <dt>N</dt>
<dd><p>the number of observations used</p></dd>

  <dt>outcome</dt>
<dd><p>the name of the outcome variable</p></dd>

  <dt>design</dt>
<dd><p>the name of the design learned from the arguments passed</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This function implements a difference-in-means estimator, with
support for blocked, clustered, matched-pairs, block-clustered, and
matched-pair clustered designs. One specifies their design by passing
the blocks and clusters in their data and this function chooses which
estimator is most appropriate.</p>
<p>If you pass only <code>blocks</code>, if all blocks are of size two, we will
infer that the design is a matched-pairs design. If they are all size four
or larger, we will infer that it is a regular blocked design. If you pass
both <code>blocks</code> and <code>clusters</code>, we will similarly
infer whether it is a matched-pairs clustered design or a block-clustered
design the number of clusters per block. If the user passes only
<code>clusters</code>, we will infer that the design was cluster-randomized. If
the user specifies neither the <code>blocks</code> nor the <code>clusters</code>,
a regular Welch's t-test will be performed.</p>
<p>Importantly, if the user specifies weights, the estimation is handed off
to <code><a href="lm_robust.html">lm_robust</a></code> with the appropriate robust standard errors
as weighted difference-in-means estimators are not implemented here.
More details of the about each of the estimators can be found in the
<a href="https://declaredesign.org/r/estimatr/articles/mathematical-notes.html">mathematical notes</a>.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Gerber, Alan S, and Donald P Green. 2012. Field Experiments: Design, Analysis, and Interpretation. New York: W.W. Norton.</p>
<p>Imai, Kosuke, Gary King, Clayton Nall. 2009. "The Essential Role of Pair Matching in Cluster-Randomized Experiments, with Application to the Mexican Universal Health Insurance Evaluation." Statistical Science 24 (1). Institute of Mathematical Statistics: 29-53. <a href="https://doi.org/10.1214/08-STS274" class="external-link">doi:10.1214/08-STS274</a>
.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="lm_lin.html">lm_lin</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://declaredesign.org/r/fabricatr/" class="external-link">fabricatr</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://declaredesign.org/r/randomizr/" class="external-link">randomizr</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Get appropriate standard errors for unit-randomized designs</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># ----------</span></span></span>
<span class="r-in"><span><span class="co"># 1. Unit randomized</span></span></span>
<span class="r-in"><span><span class="co"># ----------</span></span></span>
<span class="r-in"><span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://declaredesign.org/r/fabricatr/reference/fabricate.html" class="external-link">fabricate</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  N <span class="op">=</span> <span class="fl">100</span>,</span></span>
<span class="r-in"><span>  Y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  Z_comp <span class="op">=</span> <span class="fu"><a href="https://declaredesign.org/r/randomizr/reference/complete_ra.html" class="external-link">complete_ra</a></span><span class="op">(</span><span class="va">N</span>, prob <span class="op">=</span> <span class="fl">0.4</span><span class="op">)</span>,</span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">Z_comp</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0  1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 60 40 </span>
<span class="r-in"><span><span class="fu">difference_in_means</span><span class="op">(</span><span class="va">Y</span> <span class="op">~</span> <span class="va">Z_comp</span>, data <span class="op">=</span> <span class="va">dat</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Design:  Standard </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          Estimate Std. Error  t value  Pr(&gt;|t|)   CI Lower  CI Upper       DF</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Z_comp -0.2507099  0.2201064 -1.13904 0.2580092 -0.6885835 0.1871636 81.85383</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># ----------</span></span></span>
<span class="r-in"><span><span class="co"># 2. Cluster randomized</span></span></span>
<span class="r-in"><span><span class="co"># ----------</span></span></span>
<span class="r-in"><span><span class="co"># Accurates estimates and standard errors for clustered designs</span></span></span>
<span class="r-in"><span><span class="va">dat</span><span class="op">$</span><span class="va">clust</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">20</span>, size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dat</span><span class="op">$</span><span class="va">Z_clust</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://declaredesign.org/r/randomizr/reference/cluster_ra.html" class="external-link">cluster_ra</a></span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">clust</span>, prob <span class="op">=</span> <span class="fl">0.6</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">Z_clust</span>, <span class="va">dat</span><span class="op">$</span><span class="va">clust</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   0  0  0  0  3  5  5  0  4  0  6  3  0  0  0  3  3  0  0  0  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   1  7  5  3  0  0  0  2  0  4  0  0  9  3  6  0  0  5  6 10  8</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="fu">difference_in_means</span><span class="op">(</span><span class="va">Y</span> <span class="op">~</span> <span class="va">Z_clust</span>, clusters <span class="op">=</span> <span class="va">clust</span>, data <span class="op">=</span> <span class="va">dat</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $coefficients</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           Estimate Std. Error   t value  Pr(&gt;|t|)   CI Lower  CI Upper       DF</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Z_clust 0.03587503  0.1505211 0.2383389 0.8156236 -0.2919361 0.3636861 12.04843</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $design</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Clustered"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># ----------</span></span></span>
<span class="r-in"><span><span class="co"># 3. Block randomized</span></span></span>
<span class="r-in"><span><span class="co"># ----------</span></span></span>
<span class="r-in"><span><span class="va">dat</span><span class="op">$</span><span class="va">block</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, each <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dat</span><span class="op">$</span><span class="va">Z_block</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://declaredesign.org/r/randomizr/reference/block_ra.html" class="external-link">block_ra</a></span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">block</span>, prob <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">Z_block</span>, <span class="va">dat</span><span class="op">$</span><span class="va">block</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     1 2 3 4 5 6 7 8 9 10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   0 5 5 5 5 5 5 5 5 5  5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   1 5 5 5 5 5 5 5 5 5  5</span>
<span class="r-in"><span><span class="fu">difference_in_means</span><span class="op">(</span><span class="va">Y</span> <span class="op">~</span> <span class="va">Z_block</span>, blocks <span class="op">=</span> <span class="va">block</span>, data <span class="op">=</span> <span class="va">dat</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Design:  Blocked </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          Estimate Std. Error   t value  Pr(&gt;|t|)   CI Lower   CI Upper DF</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Z_block -0.324943  0.2072348 -1.567994 0.1208296 -0.7373534 0.08746743 80</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># ----------</span></span></span>
<span class="r-in"><span><span class="co"># 4. Block cluster randomized</span></span></span>
<span class="r-in"><span><span class="co"># ----------</span></span></span>
<span class="r-in"><span><span class="co"># Learns this design if there are two clusters per block</span></span></span>
<span class="r-in"><span><span class="va">dat</span><span class="op">$</span><span class="va">small_clust</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">50</span>, each <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dat</span><span class="op">$</span><span class="va">big_blocks</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, each <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">dat</span><span class="op">$</span><span class="va">Z_blcl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://declaredesign.org/r/randomizr/reference/block_and_cluster_ra.html" class="external-link">block_and_cluster_ra</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  blocks <span class="op">=</span> <span class="va">dat</span><span class="op">$</span><span class="va">big_blocks</span>,</span></span>
<span class="r-in"><span>  clusters <span class="op">=</span> <span class="va">dat</span><span class="op">$</span><span class="va">small_clust</span></span></span>
<span class="r-in"><span> <span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">difference_in_means</span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">Y</span> <span class="op">~</span> <span class="va">Z_blcl</span>,</span></span>
<span class="r-in"><span>  blocks <span class="op">=</span> <span class="va">big_blocks</span>,</span></span>
<span class="r-in"><span>  clusters <span class="op">=</span> <span class="va">small_clust</span>,</span></span>
<span class="r-in"><span>  data <span class="op">=</span> <span class="va">dat</span></span></span>
<span class="r-in"><span> <span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Design:  Block-clustered </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           Estimate Std. Error    t value  Pr(&gt;|t|)   CI Lower  CI Upper DF</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Z_blcl -0.06538047  0.2084188 -0.3136976 0.7553808 -0.4866105 0.3558496 40</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># ----------</span></span></span>
<span class="r-in"><span><span class="co"># 5. Matched-pairs</span></span></span>
<span class="r-in"><span><span class="co"># ----------</span></span></span>
<span class="r-in"><span><span class="co"># Matched-pair estimates and standard errors are also accurate</span></span></span>
<span class="r-in"><span><span class="co"># Specified same as blocked design, function learns that</span></span></span>
<span class="r-in"><span><span class="co"># it is matched pair from size of blocks!</span></span></span>
<span class="r-in"><span><span class="va">dat</span><span class="op">$</span><span class="va">pairs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">50</span>, each <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dat</span><span class="op">$</span><span class="va">Z_pairs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://declaredesign.org/r/randomizr/reference/block_ra.html" class="external-link">block_ra</a></span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">pairs</span>, prob <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">pairs</span>, <span class="va">dat</span><span class="op">$</span><span class="va">Z_pairs</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   1  1 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   2  1 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   3  1 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   4  1 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   5  1 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   6  1 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   7  1 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   8  1 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   9  1 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   10 1 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   11 1 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   12 1 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   13 1 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   14 1 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   15 1 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   16 1 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   17 1 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   18 1 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   19 1 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   20 1 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   21 1 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   22 1 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   23 1 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   24 1 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   25 1 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   26 1 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   27 1 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   28 1 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   29 1 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   30 1 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   31 1 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   32 1 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   33 1 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   34 1 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   35 1 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   36 1 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   37 1 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   38 1 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   39 1 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   40 1 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   41 1 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   42 1 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   43 1 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   44 1 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   45 1 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   46 1 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   47 1 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   48 1 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   49 1 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   50 1 1</span>
<span class="r-in"><span><span class="fu">difference_in_means</span><span class="op">(</span><span class="va">Y</span> <span class="op">~</span> <span class="va">Z_pairs</span>, blocks <span class="op">=</span> <span class="va">pairs</span>, data <span class="op">=</span> <span class="va">dat</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Design:  Matched-pair </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           Estimate Std. Error   t value  Pr(&gt;|t|)   CI Lower  CI Upper DF</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Z_pairs 0.09694788  0.2123318 0.4565866 0.6499858 -0.3297489 0.5236447 49</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># ----------</span></span></span>
<span class="r-in"><span><span class="co"># 6. Matched-pair cluster randomized</span></span></span>
<span class="r-in"><span><span class="co"># ----------</span></span></span>
<span class="r-in"><span><span class="co"># Learns this design if there are two clusters per block</span></span></span>
<span class="r-in"><span><span class="va">dat</span><span class="op">$</span><span class="va">small_clust</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">50</span>, each <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dat</span><span class="op">$</span><span class="va">cluster_pairs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">25</span>, each <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">cluster_pairs</span>, <span class="va">dat</span><span class="op">$</span><span class="va">small_clust</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   1  2 2 0 0 0 0 0 0 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   2  0 0 2 2 0 0 0 0 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   3  0 0 0 0 2 2 0 0 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   4  0 0 0 0 0 0 2 2 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   5  0 0 0 0 0 0 0 0 2  2  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   6  0 0 0 0 0 0 0 0 0  0  2  2  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   7  0 0 0 0 0 0 0 0 0  0  0  0  2  2  0  0  0  0  0  0  0  0  0  0  0  0  0  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   8  0 0 0 0 0 0 0 0 0  0  0  0  0  0  2  2  0  0  0  0  0  0  0  0  0  0  0  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   9  0 0 0 0 0 0 0 0 0  0  0  0  0  0  0  0  2  2  0  0  0  0  0  0  0  0  0  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   10 0 0 0 0 0 0 0 0 0  0  0  0  0  0  0  0  0  0  2  2  0  0  0  0  0  0  0  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   11 0 0 0 0 0 0 0 0 0  0  0  0  0  0  0  0  0  0  0  0  2  2  0  0  0  0  0  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   12 0 0 0 0 0 0 0 0 0  0  0  0  0  0  0  0  0  0  0  0  0  0  2  2  0  0  0  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   13 0 0 0 0 0 0 0 0 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  2  2  0  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   14 0 0 0 0 0 0 0 0 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  2  2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   15 0 0 0 0 0 0 0 0 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   16 0 0 0 0 0 0 0 0 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   17 0 0 0 0 0 0 0 0 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   18 0 0 0 0 0 0 0 0 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   19 0 0 0 0 0 0 0 0 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   20 0 0 0 0 0 0 0 0 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   21 0 0 0 0 0 0 0 0 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   22 0 0 0 0 0 0 0 0 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   23 0 0 0 0 0 0 0 0 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   24 0 0 0 0 0 0 0 0 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   25 0 0 0 0 0 0 0 0 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   1   0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   2   0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   3   0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   4   0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   5   0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   6   0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   7   0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   8   0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   9   0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   10  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   11  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   12  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   13  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   14  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   15  2  2  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   16  0  0  2  2  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   17  0  0  0  0  2  2  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   18  0  0  0  0  0  0  2  2  0  0  0  0  0  0  0  0  0  0  0  0  0  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   19  0  0  0  0  0  0  0  0  2  2  0  0  0  0  0  0  0  0  0  0  0  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   20  0  0  0  0  0  0  0  0  0  0  2  2  0  0  0  0  0  0  0  0  0  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   21  0  0  0  0  0  0  0  0  0  0  0  0  2  2  0  0  0  0  0  0  0  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   22  0  0  0  0  0  0  0  0  0  0  0  0  0  0  2  2  0  0  0  0  0  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   23  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  2  2  0  0  0  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   24  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  2  2  0  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   25  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  2  2</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">dat</span><span class="op">$</span><span class="va">Z_mpcl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://declaredesign.org/r/randomizr/reference/block_and_cluster_ra.html" class="external-link">block_and_cluster_ra</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  blocks <span class="op">=</span> <span class="va">dat</span><span class="op">$</span><span class="va">cluster_pairs</span>,</span></span>
<span class="r-in"><span>  clusters <span class="op">=</span> <span class="va">dat</span><span class="op">$</span><span class="va">small_clust</span></span></span>
<span class="r-in"><span> <span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">difference_in_means</span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">Y</span> <span class="op">~</span> <span class="va">Z_mpcl</span>,</span></span>
<span class="r-in"><span>  blocks <span class="op">=</span> <span class="va">cluster_pairs</span>,</span></span>
<span class="r-in"><span>  clusters <span class="op">=</span> <span class="va">small_clust</span>,</span></span>
<span class="r-in"><span>  data <span class="op">=</span> <span class="va">dat</span></span></span>
<span class="r-in"><span> <span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Design:  Matched-pair clustered </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           Estimate Std. Error     t value  Pr(&gt;|t|)   CI Lower  CI Upper DF</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Z_mpcl -0.02432186  0.2629019 -0.09251306 0.9270583 -0.5669248 0.5182811 24</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># ----------</span></span></span>
<span class="r-in"><span><span class="co"># Other examples</span></span></span>
<span class="r-in"><span><span class="co"># ----------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Also works with multi-valued treatments if users specify</span></span></span>
<span class="r-in"><span><span class="co"># comparison of interest</span></span></span>
<span class="r-in"><span><span class="va">dat</span><span class="op">$</span><span class="va">Z_multi</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://declaredesign.org/r/randomizr/reference/simple_ra.html" class="external-link">simple_ra</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  conditions <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Treatment 2"</span>, <span class="st">"Treatment 1"</span>, <span class="st">"Control"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  prob_each <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.4</span>, <span class="fl">0.4</span>, <span class="fl">0.2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Only need to specify which condition is treated `condition2` and</span></span></span>
<span class="r-in"><span><span class="co"># which is control `condition1`</span></span></span>
<span class="r-in"><span><span class="fu">difference_in_means</span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">Y</span> <span class="op">~</span> <span class="va">Z_multi</span>,</span></span>
<span class="r-in"><span>  condition1 <span class="op">=</span> <span class="st">"Treatment 2"</span>,</span></span>
<span class="r-in"><span>  condition2 <span class="op">=</span> <span class="st">"Control"</span>,</span></span>
<span class="r-in"><span>  data <span class="op">=</span> <span class="va">dat</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Design:  Standard </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 Estimate Std. Error  t value  Pr(&gt;|t|)   CI Lower  CI Upper</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Z_multiControl 0.3666715  0.2796364 1.311244 0.2006502 -0.2066837 0.9400268</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                      DF</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Z_multiControl 27.42038</span>
<span class="r-in"><span><span class="fu">difference_in_means</span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">Y</span> <span class="op">~</span> <span class="va">Z_multi</span>,</span></span>
<span class="r-in"><span>  condition1 <span class="op">=</span> <span class="st">"Treatment 1"</span>,</span></span>
<span class="r-in"><span>  condition2 <span class="op">=</span> <span class="st">"Control"</span>,</span></span>
<span class="r-in"><span>  data <span class="op">=</span> <span class="va">dat</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Design:  Standard </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 Estimate Std. Error t value  Pr(&gt;|t|)   CI Lower  CI Upper</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Z_multiControl 0.4226917  0.2798782 1.51027 0.1419824 -0.1501582 0.9955417</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                      DF</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Z_multiControl 28.50191</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Specifying weights will result in estimation via lm_robust()</span></span></span>
<span class="r-in"><span><span class="va">dat</span><span class="op">$</span><span class="va">w</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">difference_in_means</span><span class="op">(</span><span class="va">Y</span> <span class="op">~</span> <span class="va">Z_comp</span>, weights <span class="op">=</span> <span class="va">w</span>, data <span class="op">=</span> <span class="va">dat</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Design:  Standard (weighted) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          Estimate Std. Error   t value  Pr(&gt;|t|)   CI Lower CI Upper DF</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Z_comp -0.2586878  0.2310251 -1.119739 0.2655619 -0.7171495 0.199774 98</span>
<span class="r-in"><span><span class="fu"><a href="lm_robust.html">lm_robust</a></span><span class="op">(</span><span class="va">Y</span> <span class="op">~</span> <span class="va">Z_comp</span>, weights <span class="op">=</span> <span class="va">w</span>, data <span class="op">=</span> <span class="va">dat</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 Estimate Std. Error      t value  Pr(&gt;|t|)   CI Lower  CI Upper</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)  0.001457311  0.1638476  0.008894306 0.9929215 -0.3236929 0.3266076</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Z_comp      -0.258687779  0.2310251 -1.119738938 0.2655619 -0.7171495 0.1997740</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             DF</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept) 98</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Z_comp      98</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Graeme Blair, Jasper Cooper, Alexander Coppock, Macartan Humphreys, Luke Sonnet.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

